<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>Contact • SF Speed Cameras</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <meta name="format-detection" content="telephone=no,address=no,email=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="icons/icon-192.png">
  <link rel="manifest" id="app-manifest" href="">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Repo/base detection (same pattern as index) -->
  <script>
    (function () {
      const REPO = 'sf-speed-alerts';
      const path = location.pathname.replace(/\/+$/, '');
      const onRepo = location.hostname.endsWith('github.io') && path.startsWith('/' + REPO);
      let base = onRepo ? ('/' + REPO) : '';
      if (!base) {
        const parts = location.pathname.split('/');
        const idx = parts.lastIndexOf(REPO);
        if (idx > -1) base = '/' + parts.slice(1, idx + 1).join('/');
      }
      window.BASE = base;
      window.DEV = /[?&]dev=1\b/.test(location.search);
      const m = document.getElementById('app-manifest');
      if (m) m.setAttribute('href', `${base}/manifest.json`);
    })();
  </script>
  <style>
    :root{
      --shell-max: 520px;
    }
    html, body { height:100%; }
    body{
      margin:0; background:#0b0b0b; color:#fff;
      font-family:system-ui,-apple-system,Arial; font-weight:600;
      display:flex; flex-direction:column; overflow-x:hidden;
    }
    .video-bg{
      position:fixed; left:0; top:0; width:100vw; height:100dvh;
      z-index:-3; overflow:hidden;
    }
    .video-bg video{
      position:absolute; inset:0; width:100%; height:100%;
      object-fit:cover; object-position:center center;
      filter:brightness(.45) saturate(1.1);
    }
    .page { flex:1 0 auto; position:relative; }
    .content-wrap{ position:relative; padding:24px 20px 32px; z-index:3; }
    .app-shell{ width:min(92vw, var(--shell-max)); margin:0 auto; }
    .card{ background:rgba(255,255,255,.06); backdrop-filter: blur(6px); border:1px solid rgba(255,255,255,.12); border-radius:0; }
    .btn, .form-control, .form-select{ border-radius:0 !important; }
    .form-control, .form-select{
      background:rgba(255,255,255,.08); color:#fff; border-color:rgba(255,255,255,.22);
    }
    .form-control:focus, .form-select:focus{
      box-shadow:none; border-color:#5aa2ff; background:rgba(255,255,255,.10);
    }
    .btn-primary{ font-weight:700; }
    footer { flex:0 0 auto; padding:14px 0 calc(18px + env(safe-area-inset-bottom)); text-align:center; }
    a { color:#9ecbff; }
  </style>
</head>
<body>
  <!-- Background video (same file/pathing as index) -->
  <div class="video-bg" aria-hidden="true">
    <video id="bgvid" autoplay loop muted playsinline preload="auto" crossorigin="anonymous">
      <source id="bgvidSrc" src="" type="video/mp4">
    </video>
  </div>

  <div class="page">
    <div class="content-wrap">
      <div class="app-shell">
        <div class="d-flex align-items-center justify-content-between mb-3">
          <a class="btn btn-outline-light btn-sm" id="homeLink" href="/">← Back</a>
          <h1 class="h4 m-0">Contact</h1>
        </div>

        <div class="card">
          <div class="card-body">
            <p class="mb-3 text-white-50">Questions, issues, or feedback about SF Speed Cameras? Send us a note — it opens your mail app with everything prefilled.</p>

            <form id="contactForm" novalidate class="row g-3">
              <div class="col-12">
                <label for="name" class="form-label">Your name</label>
                <input type="text" id="name" class="form-control" placeholder="Jane Driver" required>
                <div class="invalid-feedback">Please enter your name.</div>
              </div>

              <div class="col-12 col-md-6">
                <label for="email" class="form-label">Email (reply-to)</label>
                <input type="email" id="email" class="form-control" placeholder="you@example.com" required>
                <div class="invalid-feedback">Please enter a valid email.</div>
              </div>

              <div class="col-12 col-md-6">
                <label for="topic" class="form-label">Topic</label>
                <select id="topic" class="form-select">
                  <option value="General">General</option>
                  <option value="Bug report">Bug report</option>
                  <option value="Feature request">Feature request</option>
                  <option value="Billing / Pro">Billing / Pro</option>
                </select>
              </div>

              <div class="col-12">
                <label for="subject" class="form-label">Subject</label>
                <input type="text" id="subject" class="form-control" placeholder="Short summary" required>
                <div class="invalid-feedback">Please add a subject.</div>
              </div>

              <div class="col-12">
                <label for="message" class="form-label">Message</label>
                <textarea id="message" class="form-control" rows="6" placeholder="Tell us what's up…" required></textarea>
                <div class="invalid-feedback">Please include a message.</div>
              </div>

              <div class="col-12 d-flex gap-2">
                <button type="submit" class="btn btn-primary">Open email composer</button>
                <a id="mailtoPreview" class="btn btn-outline-light d-none" href="#">Open again</a>
              </div>

              <div class="col-12 small text-white-50 mt-1">
                Or email us directly: <a href="mailto:speedwarnsf@gmail.com">speedwarnsf@gmail.com</a>
              </div>
            </form>
          </div>
        </div>

        <div class="text-center mt-3">
          <a id="privacyLink" href="/privacy.html" class="text-white-50">Privacy</a>
        </div>
      </div>
    </div>
  </div>

  <footer>
    <small>&copy; 2025–2026 SF Speed Cameras • <a id="privacyLink2" href="/privacy.html" class="text-white-50">Privacy</a></small>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" defer></script>
  <script>
    // withBase helper (same as index)
    function withBase(url) {
      const base = window.BASE || '';
      if (/^https?:\/\//.test(url)) return url;
      if (url.startsWith('/')) return `${base}${url}`;
      return `${base}/${url}`;
    }

    // Background video path
    (function(){
      const bg = document.getElementById('bgvid');
      const srcEl = document.getElementById('bgvidSrc');
      if (bg && srcEl) {
        bg.muted = true; bg.setAttribute('muted',''); bg.setAttribute('playsinline',''); bg.setAttribute('webkit-playsinline','');
        srcEl.src = `${window.BASE || ''}/videos/background.mp4`;
        bg.load();
        const retry = () => { const p = bg.play(); if (p && p.catch) p.catch(()=>setTimeout(()=>bg.play().catch(()=>{}), 120)); };
        bg.addEventListener('loadeddata', ()=> bg.removeAttribute('poster'), { once:true });
        retry();
      }
    })();

    // Fix links to respect BASE
    (function(){
      const base = window.BASE || '';
      document.getElementById('homeLink')?.setAttribute('href', base + '/');
      document.querySelectorAll('a[href="/privacy.html"]').forEach(a => a.href = `${base}/privacy.html`);
    })();

    // Simple Bootstrap validation + mailto builder
    (function(){
      const form = document.getElementById('contactForm');
      const mailtoPreview = document.getElementById('mailtoPreview');
      const NL = '%0D%0A';

      function enc(s){ return encodeURIComponent(s || '').replace(/%20/g, '+'); }

      form.addEventListener('submit', (e)=>{
        e.preventDefault();
        form.classList.add('was-validated');
        if (!form.checkValidity()) return;

        const name = document.getElementById('name').value.trim();
        const email = document.getElementById('email').value.trim();
        const topic = document.getElementById('topic').value;
        const subjectRaw = document.getElementById('subject').value.trim() || 'Contact Form';
        const message = document.getElementById('message').value.trim();

        const subject = `[SpeedWarn] ${subjectRaw}`;
        const body =
          `Name: ${name}${NL}` +
          `Email: ${email}${NL}` +
          `Topic: ${topic}${NL}${NL}` +
          `Message:${NL}${message}${NL}${NL}` +
          `— Sent from speedwarn.com/contact`;

        const href = `mailto:speedwarnsf@gmail.com?subject=${enc(subject)}&body=${enc(body)}`;
        mailtoPreview.classList.remove('d-none');
        mailtoPreview.href = href;

        // Open the user's mail client
        window.location.href = href;
      });
    })();
  </script>
</body>
</html>

